// Generated by CoffeeScript 1.7.1
(function() {
  define(['server-manager', 'storage', 'text!../testdata/servers.json'], function(ServerManager, Storage, testServers) {
    testServers = JSON.parse(testServers);
    return describe('Server Manager', function() {
      beforeEach(function() {
        this.sandbox = sinon.sandbox.create();
        return this.storageStub = this.sandbox.stub(Storage, 'get', function() {
          return testServers;
        });
      });
      afterEach(function() {
        return this.sandbox.restore();
      });
      return describe('Initialisation', function() {
        it('should call loadServersFromStorage and fetchServerList on init', function() {
          var stub, stubs, _i, _len, _results;
          stubs = [this.sandbox.stub(ServerManager, 'loadServersFromStorage'), this.sandbox.stub(ServerManager, 'fetchServerList')];
          ServerManager.init();
          _results = [];
          for (_i = 0, _len = stubs.length; _i < _len; _i++) {
            stub = stubs[_i];
            _results.push(assert.isTrue(stub.calledOnce, 'called correct function on init'));
          }
          return _results;
        });
        it('should read the server configuration from local storage', function() {
          ServerManager.loadServersFromStorage();
          assert.isTrue(this.storageStub.calledOnce);
          return assert.isTrue(this.storageStub.calledWith('server_config'));
        });
        return it('should ajax load the server list', function() {});
      });
    });
  });

}).call(this);
